<!doctype html>
<html>
<head>
<meta name="author" content="Pierre Quentel">
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jqueryUI.js"></script>
<link rel="stylesheet" href="jqueryUI.css"/>
<link rel="stylesheet" href="style.css"/>
<script type="text/javascript">
$(document).ready(function(){

    $('.audiostrip').each(function(){
    var n = $(this).attr('name')
        $(this).append('<div class="name">'+n+'</div>')
        //$(this).append('<div class="horizontal-slider" name="'+n+'" param="Pan"></div>')
        $(this).append('<div class="vertical-slider" name="'+n+'" param="Gain"></div>')
        //$(this).append('<div class="toggle" name="'+n+'" param="Mute">Mute</div>')
    })


    $('.vertical-slider').slider({orientation: 'vertical',min:0,max:1,step:0.001,range: "min",value:0.921})
    $('.vertical-slider .ui-slider-handle').each(function(){$(this).append('<div class="value">'+$(this).parent('.vertical-slider').slider('value')+'</div>')})
    $('.vertical-slider').on( "slide", function( event, ui ) {
        $(this).find('.value').text(ui.value)
        sendOsc($(this).attr('param'), $(this).attr('name'), ui.value)
        if ($('.vertical-slider[name='+$(this).attr('name')+']').length > 1) {
            $('.vertical-slider[name='+$(this).attr('name')+']').not(this).slider('value',ui.value).find('.value').text(ui.value)
        }
    });
    $('.horizontal-slider').slider({orientation: 'horizontal',min:-1,max:1,step:0.01})
    $('.horizontal-slider .ui-slider-handle').each(function(){$(this).append('<div class="value">'+$(this).parent('.horizontal-slider').slider('value')+'</div>')})
    $('.horizontal-slider').on( "slide", function( event, ui ) {
        $(this).find('.value').text(ui.value)
        sendOsc($(this).attr('param'), $(this).attr('name'), ui.value)
        if ($('.horizontal-slider[name='+$(this).attr('name')+']').length > 1) {
            $('.horizontal-slider[name='+$(this).attr('name')+']').not(this).slider('value',ui.value).find('.value').text(ui.value)
        }
    });
    
    $('.name').button()
    $('.name').each(function(){
        var name =  $(this).text()
        if ($('#'+name).length != 0) {
            $(this).click(function(){
                var index = $('#tabs a[href="#'+name+'"]').parent().index();
                $('#tabs').tabs({active:index});
            })
        } else {
            $(this).addClass('disabled')
        }
    })
    
    $('.toggle').button()
    $('.toggle').click(function(){
        $(this).toggleClass('enabled');
        if ($(this).hasClass('enabled')) { value = 1.0 } else { value = 0.0 };
        sendOsc($(this).attr('param'), $(this).attr('name'), value);
        if ($('.toggle[name='+$(this).attr('name')+']').length > 1) {
            $('.toggle[name='+$(this).attr('name')+']').not(this).toggleClass('enabled')
        }
    });
    
    $('#tabs').tabs();
    
    $('#fullscreen').click(function(){
      $(this).attr('data-e',Math.abs($(this).attr('data-e')-1));
      var e = $(this).attr('data-e');
      toggleFullscreen(e);
    });
    
})

function savePreset() {
    var preset = ''
    $('.horizontal-slider, .vertical-slider').each(function(){
        preset += $(this).attr('param') + ' ' + $(this).attr('name') + ' ' + $(this).slider('value') + ';'
    })
    $('.toggle').each(function(){
        if ($(this).hasClass('enabled')) { var value = 1 } else { var value =0 }
        preset += $(this).attr('param') + ' ' + $(this).attr('name') + ' ' + value + ';'
    })
    document.title = 'Save' + ',' + preset
}
function loadPreset() {
    document.title = 'Load'
}


function setValue(param,name,value) {
    $('[param='+param+'][name='+name+']').each(function(){
    if ($(this).hasClass('horizontal-slider') || $(this).hasClass('vertical-slider') ) {
        $(this).slider('value',value)
        $(this).find('.value').text(value)
    }
    if ($(this).hasClass('toggle')) {
        if (value == 1) {$(this).addClass('enabled')}
        if (value == 0) {$(this).removeClass('enabled')}
    }
    })
}
function sendOsc(param, name, value){
    document.title = param + ',' + name + ',' + value
} 
function toggleFullscreen(e){
  document.title = 'Fullscreen,' + e
}

</script>
<style>
.vertical-slider {
  top: 50px!important;
  bottom: 20px!important;
}
#tabs {
  top:60px!important;
}
.name {
  font-weight:bold;
}
</style>
</head>

<body>

<div class="left">
<div class="name" onclick="loadPreset();">Load</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<div class="name" onclick="savePreset();">Save</div>
</div>
<div class="name right" id="fullscreen" data-e="0">Fullscreen</div>


<div id="tabs">
    <ul>
    <li><a href="#MainMix">XXX</a></li>
    <!--<li><a href="#MonitorsJeannot">MonitorsJeannot</a></li>-->
    </ul>
    <div id="MainMix">
    <table class="table"><tr>
        <td><div class="audiostrip"  name="Drums"></div></td>
        <td><div class="audiostrip"  name="Basses"></div></td>
        <td><div class="audiostrip"  name="Guitars"></div></td>
        <td><div class="audiostrip"  name="MxSynths"></div></td>
        <td><div class="audiostrip"  name="MxDrums"></div></td>
        <td><div class="audiostrip"  name="Vocals"></div></td>
	<td><div class="audiostrip"  name="Acoustics"></div></td>
        <td><div class="audiostrip main"  name="FOH"></div></td>
        <!--<td> </td>
        <td><div class="audiostrip"  name="DecoupeOrl"></div></td>
        <td><div class="audiostrip"  name="DecoupeJeannot"></div></td>-->
    </tr></table>
    </div><!--
    <div id="MonitorsJeannot">
    <table class="table"><tr>
        <td><div class="audiostrip"  name="mjMainMix"></div></td>
        <td><div class="audiostrip"  name="mjDrums"></div></td>
        <td><div class="audiostrip"  name="mjVocals"></div></td>
        <td><div class="audiostrip"  name="mjGuitars"></div></td>
        <td><div class="audiostrip"  name="mjBasses"></div></td>
        <td><div class="audiostrip"  name="mjMetronome"></div></td>
        <td><div class="audiostrip main"  name="MonitorsJeannot"></div></td>
    </tr></table>
    </div>-->
</div>

</body>
</html>	
